{"ast":null,"code":"import _toConsumableArray from \"/root/FrontPlatform/vue-front/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport \"core-js/modules/es.number.to-fixed.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.replace.js\";\nimport \"core-js/modules/es.number.is-nan.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.array.index-of.js\";\nimport \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport { defineComponent, ref, onMounted, onUnmounted, createVNode, mergeProps, createTextVNode, cloneVNode } from \"vue\";\nimport ResizeObserver from \"resize-observer-polyfill\";\nimport { getStyle } from \"../_utils/style.js\";\nimport useMenuContext from \"./hooks/use-menu-context.js\";\nimport SubMenu from \"./sub-menu.js\";\nimport { unFragment } from \"../_utils/vue-utils.js\";\nvar OVERFLOW_THRESHOLD = 10;\nfunction getNodeWidth(el) {\n  return el && +el.getBoundingClientRect().width.toFixed(2);\n}\nfunction translatePxToNumber(str) {\n  var result = Number(str.replace(\"px\", \"\"));\n  return Number.isNaN(result) ? 0 : result;\n}\nvar OverflowWrap = defineComponent({\n  name: \"MenuOverflowWrap\",\n  setup: function setup(_, _ref) {\n    var slots = _ref.slots;\n    var menuContext = useMenuContext();\n    var overflowPrefixCls = \"\".concat(menuContext.prefixCls, \"-overflow\");\n    var overflowSubMenuClass = \"\".concat(overflowPrefixCls, \"-sub-menu\");\n    var overflowMenuItemClass = \"\".concat(overflowPrefixCls, \"-hidden-menu-item\");\n    var overflowSubMenuMirrorClass = \"\".concat(overflowPrefixCls, \"-sub-menu-mirror\");\n    var refWrapper = ref();\n    var lastVisibleIndex = ref(null);\n    var refResizeObserver = ref();\n    function computeLastVisibleIndex() {\n      var wrapperElement = refWrapper.value;\n      var wrapperWidth = getNodeWidth(wrapperElement);\n      var childNodeList = [].slice.call(wrapperElement.children);\n      var menuItemIndex = 0;\n      var currentRightWidth = 0;\n      var overflowSubMenuWidth = 0;\n      for (var i = 0; i < childNodeList.length; i++) {\n        var node = childNodeList[i];\n        var classNames = node.className.split(\" \");\n        var isOverflowSubMenu = classNames.indexOf(overflowSubMenuClass) > -1;\n        var isOverflowSubMenuMirror = classNames.indexOf(overflowSubMenuMirrorClass) > -1;\n        if (isOverflowSubMenu) {\n          continue;\n        }\n        var nodeWidth = getNodeWidth(node) + translatePxToNumber(getStyle(node, \"marginLeft\")) + translatePxToNumber(getStyle(node, \"marginRight\"));\n        if (isOverflowSubMenuMirror) {\n          overflowSubMenuWidth = nodeWidth;\n          continue;\n        }\n        currentRightWidth += nodeWidth;\n        if (currentRightWidth + overflowSubMenuWidth + OVERFLOW_THRESHOLD > wrapperWidth) {\n          lastVisibleIndex.value = menuItemIndex - 1;\n          return;\n        }\n        menuItemIndex++;\n      }\n      lastVisibleIndex.value = null;\n    }\n    onMounted(function () {\n      computeLastVisibleIndex();\n      refResizeObserver.value = new ResizeObserver(function (entries) {\n        entries.forEach(computeLastVisibleIndex);\n      });\n      if (refWrapper.value) {\n        refResizeObserver.value.observe(refWrapper.value);\n      }\n    });\n    onUnmounted(function () {\n      refResizeObserver.value && refResizeObserver.value.disconnect();\n    });\n    return function () {\n      var renderSubMenu = function renderSubMenu(children, options) {\n        var _ref2 = options || {},\n          _ref2$isMirror = _ref2.isMirror,\n          isMirror = _ref2$isMirror === void 0 ? false : _ref2$isMirror,\n          _ref2$props = _ref2.props,\n          props = _ref2$props === void 0 ? {} : _ref2$props;\n        return createVNode(SubMenu, mergeProps({\n          \"key\": \"__arco-menu-overflow-sub-menu\".concat(isMirror ? \"-mirror\" : \"\"),\n          \"class\": isMirror ? overflowSubMenuMirrorClass : overflowSubMenuClass\n        }, props), {\n          title: function title() {\n            return createVNode(\"span\", null, [createTextVNode(\"...\")]);\n          },\n          \"default\": function _default() {\n            return children;\n          }\n        });\n      };\n      var renderChildren = function renderChildren() {\n        var _a;\n        var originChildren = ((_a = slots[\"default\"]) == null ? void 0 : _a.call(slots)) || [];\n        var children = unFragment(originChildren);\n        var overflowSubMenu = null;\n        var overflowSubMenuMirror = renderSubMenu(null, {\n          isMirror: true\n        });\n        var menuItems = children.map(function (child, index) {\n          var item = cloneVNode(child, lastVisibleIndex.value !== null && index > lastVisibleIndex.value ? {\n            \"class\": overflowMenuItemClass\n          } : {\n            \"class\": \"\"\n          });\n          if (lastVisibleIndex.value !== null && index === lastVisibleIndex.value + 1) {\n            var overflowMenuItems = children.slice(index).map(function (child2) {\n              return cloneVNode(child2);\n            });\n            overflowSubMenu = renderSubMenu(overflowMenuItems);\n          }\n          return item;\n        });\n        return [overflowSubMenuMirror].concat(_toConsumableArray(menuItems), [overflowSubMenu]);\n      };\n      return createVNode(\"div\", {\n        \"class\": \"\".concat(overflowPrefixCls, \"-wrap\"),\n        \"ref\": refWrapper\n      }, [renderChildren()]);\n    };\n  }\n});\nexport { OverflowWrap as default };","map":{"version":3,"names":["defineComponent","ref","onMounted","onUnmounted","createVNode","mergeProps","createTextVNode","cloneVNode","ResizeObserver","getStyle","useMenuContext","SubMenu","unFragment","OVERFLOW_THRESHOLD","getNodeWidth","el","getBoundingClientRect","width","toFixed","translatePxToNumber","str","result","Number","replace","isNaN","OverflowWrap","name","setup","_","_ref","slots","menuContext","overflowPrefixCls","concat","prefixCls","overflowSubMenuClass","overflowMenuItemClass","overflowSubMenuMirrorClass","refWrapper","lastVisibleIndex","refResizeObserver","computeLastVisibleIndex","wrapperElement","value","wrapperWidth","childNodeList","slice","call","children","menuItemIndex","currentRightWidth","overflowSubMenuWidth","i","length","node","classNames","className","split","isOverflowSubMenu","indexOf","isOverflowSubMenuMirror","nodeWidth","entries","forEach","observe","disconnect","renderSubMenu","options","_ref2","_ref2$isMirror","isMirror","_ref2$props","props","title","_default","renderChildren","_a","originChildren","overflowSubMenu","overflowSubMenuMirror","menuItems","map","child","index","item","overflowMenuItems","child2","_toConsumableArray","default"],"sources":["/root/FrontPlatform/vue-front/node_modules/@arco-design/web-vue/es/menu/overflow-wrap.js"],"sourcesContent":["import { defineComponent, ref, onMounted, onUnmounted, createVNode, mergeProps, createTextVNode, cloneVNode } from \"vue\";\nimport ResizeObserver from \"resize-observer-polyfill\";\nimport { getStyle } from \"../_utils/style.js\";\nimport useMenuContext from \"./hooks/use-menu-context.js\";\nimport SubMenu from \"./sub-menu.js\";\nimport { unFragment } from \"../_utils/vue-utils.js\";\nconst OVERFLOW_THRESHOLD = 10;\nfunction getNodeWidth(el) {\n  return el && +el.getBoundingClientRect().width.toFixed(2);\n}\nfunction translatePxToNumber(str) {\n  const result = Number(str.replace(\"px\", \"\"));\n  return Number.isNaN(result) ? 0 : result;\n}\nvar OverflowWrap = defineComponent({\n  name: \"MenuOverflowWrap\",\n  setup(_, {\n    slots\n  }) {\n    const menuContext = useMenuContext();\n    const overflowPrefixCls = `${menuContext.prefixCls}-overflow`;\n    const overflowSubMenuClass = `${overflowPrefixCls}-sub-menu`;\n    const overflowMenuItemClass = `${overflowPrefixCls}-hidden-menu-item`;\n    const overflowSubMenuMirrorClass = `${overflowPrefixCls}-sub-menu-mirror`;\n    const refWrapper = ref();\n    const lastVisibleIndex = ref(null);\n    const refResizeObserver = ref();\n    function computeLastVisibleIndex() {\n      const wrapperElement = refWrapper.value;\n      const wrapperWidth = getNodeWidth(wrapperElement);\n      const childNodeList = [].slice.call(wrapperElement.children);\n      let menuItemIndex = 0;\n      let currentRightWidth = 0;\n      let overflowSubMenuWidth = 0;\n      for (let i = 0; i < childNodeList.length; i++) {\n        const node = childNodeList[i];\n        const classNames = node.className.split(\" \");\n        const isOverflowSubMenu = classNames.indexOf(overflowSubMenuClass) > -1;\n        const isOverflowSubMenuMirror = classNames.indexOf(overflowSubMenuMirrorClass) > -1;\n        if (isOverflowSubMenu) {\n          continue;\n        }\n        const nodeWidth = getNodeWidth(node) + translatePxToNumber(getStyle(node, \"marginLeft\")) + translatePxToNumber(getStyle(node, \"marginRight\"));\n        if (isOverflowSubMenuMirror) {\n          overflowSubMenuWidth = nodeWidth;\n          continue;\n        }\n        currentRightWidth += nodeWidth;\n        if (currentRightWidth + overflowSubMenuWidth + OVERFLOW_THRESHOLD > wrapperWidth) {\n          lastVisibleIndex.value = menuItemIndex - 1;\n          return;\n        }\n        menuItemIndex++;\n      }\n      lastVisibleIndex.value = null;\n    }\n    onMounted(() => {\n      computeLastVisibleIndex();\n      refResizeObserver.value = new ResizeObserver((entries) => {\n        entries.forEach(computeLastVisibleIndex);\n      });\n      if (refWrapper.value) {\n        refResizeObserver.value.observe(refWrapper.value);\n      }\n    });\n    onUnmounted(() => {\n      refResizeObserver.value && refResizeObserver.value.disconnect();\n    });\n    return () => {\n      const renderSubMenu = (children, options) => {\n        const {\n          isMirror = false,\n          props = {}\n        } = options || {};\n        return createVNode(SubMenu, mergeProps({\n          \"key\": `__arco-menu-overflow-sub-menu${isMirror ? \"-mirror\" : \"\"}`,\n          \"class\": isMirror ? overflowSubMenuMirrorClass : overflowSubMenuClass\n        }, props), {\n          title: () => createVNode(\"span\", null, [createTextVNode(\"...\")]),\n          default: () => children\n        });\n      };\n      const renderChildren = () => {\n        var _a;\n        const originChildren = ((_a = slots.default) == null ? void 0 : _a.call(slots)) || [];\n        const children = unFragment(originChildren);\n        let overflowSubMenu = null;\n        const overflowSubMenuMirror = renderSubMenu(null, {\n          isMirror: true\n        });\n        const menuItems = children.map((child, index) => {\n          const item = cloneVNode(child, lastVisibleIndex.value !== null && index > lastVisibleIndex.value ? {\n            class: overflowMenuItemClass\n          } : {\n            class: \"\"\n          });\n          if (lastVisibleIndex.value !== null && index === lastVisibleIndex.value + 1) {\n            const overflowMenuItems = children.slice(index).map((child2) => cloneVNode(child2));\n            overflowSubMenu = renderSubMenu(overflowMenuItems);\n          }\n          return item;\n        });\n        return [overflowSubMenuMirror, ...menuItems, overflowSubMenu];\n      };\n      return createVNode(\"div\", {\n        \"class\": `${overflowPrefixCls}-wrap`,\n        \"ref\": refWrapper\n      }, [renderChildren()]);\n    };\n  }\n});\nexport { OverflowWrap as default };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}