{"ast":null,"code":"import \"core-js/modules/es.map.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.array.reduce.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport { ref, computed, onMounted } from \"vue\";\nvar useSize = function useSize(_ref) {\n  var dataKeys = _ref.dataKeys,\n    contentRef = _ref.contentRef,\n    fixedSize = _ref.fixedSize,\n    estimatedSize = _ref.estimatedSize,\n    buffer = _ref.buffer;\n  var firstRangeAverageSize = ref(0);\n  var sizeMap = new Map();\n  var total = computed(function () {\n    return dataKeys.value.length;\n  });\n  var start = ref(0);\n  var end = computed(function () {\n    var _end = start.value + buffer.value * 3;\n    if (_end > total.value) return total.value;\n    return _end;\n  });\n  var maxStart = computed(function () {\n    var max = total.value - buffer.value * 3;\n    if (max < 0) return 0;\n    return max;\n  });\n  var setStart = function setStart(index) {\n    if (index < 0) {\n      start.value = 0;\n    } else if (index > maxStart.value) {\n      start.value = maxStart.value;\n    } else {\n      start.value = index;\n    }\n  };\n  var isFixed = ref(fixedSize.value);\n  var _estimatedSize = computed(function () {\n    if (estimatedSize.value !== 30) {\n      return estimatedSize.value;\n    }\n    return firstRangeAverageSize.value || estimatedSize.value;\n  });\n  var setItemSize = function setItemSize(key, size) {\n    sizeMap.set(key, size);\n  };\n  var getItemSize = function getItemSize(index) {\n    var _a;\n    if (isFixed.value) {\n      return _estimatedSize.value;\n    }\n    var _key = dataKeys.value[index];\n    return (_a = sizeMap.get(_key)) != null ? _a : _estimatedSize.value;\n  };\n  var hasItemSize = function hasItemSize(key) {\n    return sizeMap.has(key);\n  };\n  onMounted(function () {\n    var firstRangeTotalSize = Array.from(sizeMap.values()).reduce(function (pre, value) {\n      return pre + value;\n    }, 0);\n    if (firstRangeTotalSize > 0) {\n      firstRangeAverageSize.value = firstRangeTotalSize / sizeMap.size;\n    }\n  });\n  var getScrollOffset = function getScrollOffset(index) {\n    if (isFixed.value) {\n      return _estimatedSize.value * index;\n    }\n    return getOffset(0, index);\n  };\n  var getOffset = function getOffset(start2, end2) {\n    var offset = 0;\n    for (var i = start2; i < end2; i++) {\n      offset += getItemSize(i);\n    }\n    return offset;\n  };\n  var frontPadding = computed(function () {\n    if (isFixed.value) {\n      return _estimatedSize.value * start.value;\n    }\n    return getOffset(0, start.value);\n  });\n  var getOffsetIndex = function getOffsetIndex(scrollOffset) {\n    var isForward = scrollOffset >= frontPadding.value;\n    var offset = Math.abs(scrollOffset - frontPadding.value);\n    var _start = isForward ? start.value : start.value - 1;\n    var offsetIndex = 0;\n    while (offset > 0) {\n      offset -= getItemSize(_start + offsetIndex);\n      isForward ? offsetIndex++ : offsetIndex--;\n    }\n    return offsetIndex;\n  };\n  var getStartByScroll = function getStartByScroll(scrollOffset) {\n    var offsetIndex = getOffsetIndex(scrollOffset);\n    var _start = start.value + offsetIndex - buffer.value;\n    if (_start < 0) return 0;\n    if (_start > maxStart.value) return maxStart.value;\n    return _start;\n  };\n  var behindPadding = computed(function () {\n    if (isFixed.value) {\n      return _estimatedSize.value * (total.value - end.value);\n    }\n    return getOffset(end.value, total.value);\n  });\n  return {\n    frontPadding: frontPadding,\n    behindPadding: behindPadding,\n    start: start,\n    end: end,\n    getStartByScroll: getStartByScroll,\n    setItemSize: setItemSize,\n    hasItemSize: hasItemSize,\n    setStart: setStart,\n    getScrollOffset: getScrollOffset\n  };\n};\nexport { useSize };","map":{"version":3,"names":["ref","computed","onMounted","useSize","_ref","dataKeys","contentRef","fixedSize","estimatedSize","buffer","firstRangeAverageSize","sizeMap","Map","total","value","length","start","end","_end","maxStart","max","setStart","index","isFixed","_estimatedSize","setItemSize","key","size","set","getItemSize","_a","_key","get","hasItemSize","has","firstRangeTotalSize","Array","from","values","reduce","pre","getScrollOffset","getOffset","start2","end2","offset","i","frontPadding","getOffsetIndex","scrollOffset","isForward","Math","abs","_start","offsetIndex","getStartByScroll","behindPadding"],"sources":["/root/FrontPlatform/vue-front/node_modules/@arco-design/web-vue/es/_components/virtual-list-v2/hooks/use-size.js"],"sourcesContent":["import { ref, computed, onMounted } from \"vue\";\nconst useSize = ({\n  dataKeys,\n  contentRef,\n  fixedSize,\n  estimatedSize,\n  buffer\n}) => {\n  const firstRangeAverageSize = ref(0);\n  const sizeMap = new Map();\n  const total = computed(() => dataKeys.value.length);\n  const start = ref(0);\n  const end = computed(() => {\n    const _end = start.value + buffer.value * 3;\n    if (_end > total.value)\n      return total.value;\n    return _end;\n  });\n  const maxStart = computed(() => {\n    const max = total.value - buffer.value * 3;\n    if (max < 0)\n      return 0;\n    return max;\n  });\n  const setStart = (index) => {\n    if (index < 0) {\n      start.value = 0;\n    } else if (index > maxStart.value) {\n      start.value = maxStart.value;\n    } else {\n      start.value = index;\n    }\n  };\n  const isFixed = ref(fixedSize.value);\n  const _estimatedSize = computed(() => {\n    if (estimatedSize.value !== 30) {\n      return estimatedSize.value;\n    }\n    return firstRangeAverageSize.value || estimatedSize.value;\n  });\n  const setItemSize = (key, size) => {\n    sizeMap.set(key, size);\n  };\n  const getItemSize = (index) => {\n    var _a;\n    if (isFixed.value) {\n      return _estimatedSize.value;\n    }\n    const _key = dataKeys.value[index];\n    return (_a = sizeMap.get(_key)) != null ? _a : _estimatedSize.value;\n  };\n  const hasItemSize = (key) => {\n    return sizeMap.has(key);\n  };\n  onMounted(() => {\n    const firstRangeTotalSize = Array.from(sizeMap.values()).reduce((pre, value) => pre + value, 0);\n    if (firstRangeTotalSize > 0) {\n      firstRangeAverageSize.value = firstRangeTotalSize / sizeMap.size;\n    }\n  });\n  const getScrollOffset = (index) => {\n    if (isFixed.value) {\n      return _estimatedSize.value * index;\n    }\n    return getOffset(0, index);\n  };\n  const getOffset = (start2, end2) => {\n    let offset = 0;\n    for (let i = start2; i < end2; i++) {\n      offset += getItemSize(i);\n    }\n    return offset;\n  };\n  const frontPadding = computed(() => {\n    if (isFixed.value) {\n      return _estimatedSize.value * start.value;\n    }\n    return getOffset(0, start.value);\n  });\n  const getOffsetIndex = (scrollOffset) => {\n    const isForward = scrollOffset >= frontPadding.value;\n    let offset = Math.abs(scrollOffset - frontPadding.value);\n    const _start = isForward ? start.value : start.value - 1;\n    let offsetIndex = 0;\n    while (offset > 0) {\n      offset -= getItemSize(_start + offsetIndex);\n      isForward ? offsetIndex++ : offsetIndex--;\n    }\n    return offsetIndex;\n  };\n  const getStartByScroll = (scrollOffset) => {\n    const offsetIndex = getOffsetIndex(scrollOffset);\n    const _start = start.value + offsetIndex - buffer.value;\n    if (_start < 0)\n      return 0;\n    if (_start > maxStart.value)\n      return maxStart.value;\n    return _start;\n  };\n  const behindPadding = computed(() => {\n    if (isFixed.value) {\n      return _estimatedSize.value * (total.value - end.value);\n    }\n    return getOffset(end.value, total.value);\n  });\n  return {\n    frontPadding,\n    behindPadding,\n    start,\n    end,\n    getStartByScroll,\n    setItemSize,\n    hasItemSize,\n    setStart,\n    getScrollOffset\n  };\n};\nexport { useSize };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}