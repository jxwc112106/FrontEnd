{"ast":null,"code":"import { toRefs, ref } from \"vue\";\nimport { throttleByRaf } from \"../../_utils/throttle-by-raf.js\";\nimport useTreeContext from \"./use-tree-context.js\";\nfunction useDraggable(props) {\n  var _toRefs = toRefs(props),\n    key = _toRefs.key,\n    refTitle = _toRefs.refTitle;\n  var treeContext = useTreeContext();\n  var isDragOver = ref(false);\n  var isDragging = ref(false);\n  var isAllowDrop = ref(false);\n  var dropPosition = ref(0);\n  var updateDropPosition = throttleByRaf(function (e) {\n    if (!refTitle.value) return;\n    var rect = refTitle.value.getBoundingClientRect();\n    var offsetY = window.pageYOffset + rect.top;\n    var pageY = e.pageY;\n    var gapHeight = rect.height / 4;\n    var diff = pageY - offsetY;\n    dropPosition.value = diff < gapHeight ? -1 : diff < rect.height - gapHeight ? 0 : 1;\n    isAllowDrop.value = treeContext.allowDrop ? treeContext.allowDrop(key.value, dropPosition.value) : true;\n  });\n  return {\n    isDragOver: isDragOver,\n    isDragging: isDragging,\n    isAllowDrop: isAllowDrop,\n    dropPosition: dropPosition,\n    setDragStatus: function setDragStatus(status, e) {\n      switch (status) {\n        case \"dragStart\":\n          isDragging.value = true;\n          dropPosition.value = 0;\n          treeContext.onDragStart && treeContext.onDragStart(key.value, e);\n          break;\n        case \"dragEnd\":\n          isDragging.value = false;\n          isDragOver.value = false;\n          dropPosition.value = 0;\n          updateDropPosition.cancel();\n          treeContext.onDragEnd && treeContext.onDragEnd(key.value, e);\n          break;\n        case \"dragOver\":\n          isDragOver.value = true;\n          updateDropPosition(e);\n          treeContext.onDragOver && treeContext.onDragOver(key.value, e);\n          break;\n        case \"dragLeave\":\n          isDragOver.value = false;\n          dropPosition.value = 0;\n          updateDropPosition.cancel();\n          treeContext.onDragLeave && treeContext.onDragLeave(key.value, e);\n          break;\n        case \"drop\":\n          treeContext.onDrop && treeContext.onDrop(key.value, dropPosition.value, e);\n          isDragOver.value = false;\n          dropPosition.value = 0;\n          updateDropPosition.cancel();\n          break;\n      }\n    }\n  };\n}\nexport { useDraggable as default };","map":{"version":3,"names":["toRefs","ref","throttleByRaf","useTreeContext","useDraggable","props","_toRefs","key","refTitle","treeContext","isDragOver","isDragging","isAllowDrop","dropPosition","updateDropPosition","e","value","rect","getBoundingClientRect","offsetY","window","pageYOffset","top","pageY","gapHeight","height","diff","allowDrop","setDragStatus","status","onDragStart","cancel","onDragEnd","onDragOver","onDragLeave","onDrop","default"],"sources":["/root/FrontPlatform/vue-front/node_modules/@arco-design/web-vue/es/tree/hooks/use-draggable.js"],"sourcesContent":["import { toRefs, ref } from \"vue\";\nimport { throttleByRaf } from \"../../_utils/throttle-by-raf.js\";\nimport useTreeContext from \"./use-tree-context.js\";\nfunction useDraggable(props) {\n  const { key, refTitle } = toRefs(props);\n  const treeContext = useTreeContext();\n  const isDragOver = ref(false);\n  const isDragging = ref(false);\n  const isAllowDrop = ref(false);\n  const dropPosition = ref(0);\n  const updateDropPosition = throttleByRaf((e) => {\n    if (!refTitle.value)\n      return;\n    const rect = refTitle.value.getBoundingClientRect();\n    const offsetY = window.pageYOffset + rect.top;\n    const { pageY } = e;\n    const gapHeight = rect.height / 4;\n    const diff = pageY - offsetY;\n    dropPosition.value = diff < gapHeight ? -1 : diff < rect.height - gapHeight ? 0 : 1;\n    isAllowDrop.value = treeContext.allowDrop ? treeContext.allowDrop(key.value, dropPosition.value) : true;\n  });\n  return {\n    isDragOver,\n    isDragging,\n    isAllowDrop,\n    dropPosition,\n    setDragStatus(status, e) {\n      switch (status) {\n        case \"dragStart\":\n          isDragging.value = true;\n          dropPosition.value = 0;\n          treeContext.onDragStart && treeContext.onDragStart(key.value, e);\n          break;\n        case \"dragEnd\":\n          isDragging.value = false;\n          isDragOver.value = false;\n          dropPosition.value = 0;\n          updateDropPosition.cancel();\n          treeContext.onDragEnd && treeContext.onDragEnd(key.value, e);\n          break;\n        case \"dragOver\":\n          isDragOver.value = true;\n          updateDropPosition(e);\n          treeContext.onDragOver && treeContext.onDragOver(key.value, e);\n          break;\n        case \"dragLeave\":\n          isDragOver.value = false;\n          dropPosition.value = 0;\n          updateDropPosition.cancel();\n          treeContext.onDragLeave && treeContext.onDragLeave(key.value, e);\n          break;\n        case \"drop\":\n          treeContext.onDrop && treeContext.onDrop(key.value, dropPosition.value, e);\n          isDragOver.value = false;\n          dropPosition.value = 0;\n          updateDropPosition.cancel();\n          break;\n      }\n    }\n  };\n}\nexport { useDraggable as default };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}