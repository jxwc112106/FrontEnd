{"ast":null,"code":"import { toRefs, computed, reactive, ref, watch } from \"vue\";\nimport { getDayjsValue, getNow, methods } from \"../../_utils/date.js\";\nimport usePanelSpan from \"./use-panel-span.js\";\nfunction useHeaderValue(props) {\n  var _toRefs = toRefs(props),\n    mode = _toRefs.mode,\n    value = _toRefs.value,\n    defaultValue = _toRefs.defaultValue,\n    selectedValue = _toRefs.selectedValue,\n    format = _toRefs.format,\n    onChange = _toRefs.onChange;\n  var computedMode = computed(function () {\n    return (mode == null ? void 0 : mode.value) || \"date\";\n  });\n  var _usePanelSpan = usePanelSpan(reactive({\n      mode: computedMode\n    })),\n    span = _usePanelSpan.span,\n    superSpan = _usePanelSpan.superSpan;\n  var isSame = function isSame(current, target) {\n    var unit = computedMode.value === \"date\" || computedMode.value === \"week\" ? \"M\" : \"y\";\n    return current.isSame(target, unit);\n  };\n  var computedValue = computed(function () {\n    return getDayjsValue(value == null ? void 0 : value.value, format.value);\n  });\n  var computedDefaultValue = computed(function () {\n    return getDayjsValue(defaultValue == null ? void 0 : defaultValue.value, format.value);\n  });\n  var localValue = ref(computedDefaultValue.value || getNow());\n  var headerValue = computed(function () {\n    return computedValue.value || localValue.value;\n  });\n  var setLocalValue = function setLocalValue(newVal) {\n    if (!newVal) return;\n    localValue.value = newVal;\n  };\n  var setHeaderValue = function setHeaderValue(newVal) {\n    var emitChange = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    var _a;\n    if (!newVal) return;\n    if (emitChange && !isSame(headerValue.value, newVal)) {\n      (_a = onChange == null ? void 0 : onChange.value) == null ? void 0 : _a.call(onChange, newVal);\n    }\n    setLocalValue(newVal);\n  };\n  if (selectedValue == null ? void 0 : selectedValue.value) {\n    setLocalValue(selectedValue.value);\n  }\n  watch(function () {\n    return selectedValue == null ? void 0 : selectedValue.value;\n  }, function (newVal) {\n    setHeaderValue(newVal);\n  });\n  function getDefaultLocalValue() {\n    return (selectedValue == null ? void 0 : selectedValue.value) || computedDefaultValue.value || getNow();\n  }\n  function resetHeaderValue() {\n    var emitChange = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n    var defaultLocalValue = getDefaultLocalValue();\n    if (emitChange) {\n      setHeaderValue(defaultLocalValue);\n    } else {\n      setLocalValue(defaultLocalValue);\n    }\n  }\n  var showSingleBtn = computed(function () {\n    return span.value !== superSpan.value;\n  });\n  var headerOperations = computed(function () {\n    return {\n      onSuperPrev: function onSuperPrev() {\n        setHeaderValue(methods.subtract(headerValue.value, superSpan.value, \"M\"));\n      },\n      onPrev: showSingleBtn.value ? function () {\n        setHeaderValue(methods.subtract(headerValue.value, span.value, \"M\"));\n      } : void 0,\n      onNext: showSingleBtn.value ? function () {\n        setHeaderValue(methods.add(headerValue.value, span.value, \"M\"));\n      } : void 0,\n      onSuperNext: function onSuperNext() {\n        setHeaderValue(methods.add(headerValue.value, superSpan.value, \"M\"));\n      }\n    };\n  });\n  return {\n    headerValue: headerValue,\n    setHeaderValue: setHeaderValue,\n    headerOperations: headerOperations,\n    resetHeaderValue: resetHeaderValue,\n    getDefaultLocalValue: getDefaultLocalValue\n  };\n}\nexport { useHeaderValue as default };","map":{"version":3,"names":["toRefs","computed","reactive","ref","watch","getDayjsValue","getNow","methods","usePanelSpan","useHeaderValue","props","_toRefs","mode","value","defaultValue","selectedValue","format","onChange","computedMode","_usePanelSpan","span","superSpan","isSame","current","target","unit","computedValue","computedDefaultValue","localValue","headerValue","setLocalValue","newVal","setHeaderValue","emitChange","arguments","length","undefined","_a","call","getDefaultLocalValue","resetHeaderValue","defaultLocalValue","showSingleBtn","headerOperations","onSuperPrev","subtract","onPrev","onNext","add","onSuperNext","default"],"sources":["/root/FrontPlatform/vue-front/node_modules/@arco-design/web-vue/es/date-picker/hooks/use-header-value.js"],"sourcesContent":["import { toRefs, computed, reactive, ref, watch } from \"vue\";\nimport { getDayjsValue, getNow, methods } from \"../../_utils/date.js\";\nimport usePanelSpan from \"./use-panel-span.js\";\nfunction useHeaderValue(props) {\n  const { mode, value, defaultValue, selectedValue, format, onChange } = toRefs(props);\n  const computedMode = computed(() => (mode == null ? void 0 : mode.value) || \"date\");\n  const { span, superSpan } = usePanelSpan(reactive({\n    mode: computedMode\n  }));\n  const isSame = (current, target) => {\n    const unit = computedMode.value === \"date\" || computedMode.value === \"week\" ? \"M\" : \"y\";\n    return current.isSame(target, unit);\n  };\n  const computedValue = computed(() => getDayjsValue(value == null ? void 0 : value.value, format.value));\n  const computedDefaultValue = computed(() => getDayjsValue(defaultValue == null ? void 0 : defaultValue.value, format.value));\n  const localValue = ref(computedDefaultValue.value || getNow());\n  const headerValue = computed(() => computedValue.value || localValue.value);\n  const setLocalValue = (newVal) => {\n    if (!newVal)\n      return;\n    localValue.value = newVal;\n  };\n  const setHeaderValue = (newVal, emitChange = true) => {\n    var _a;\n    if (!newVal)\n      return;\n    if (emitChange && !isSame(headerValue.value, newVal)) {\n      (_a = onChange == null ? void 0 : onChange.value) == null ? void 0 : _a.call(onChange, newVal);\n    }\n    setLocalValue(newVal);\n  };\n  if (selectedValue == null ? void 0 : selectedValue.value) {\n    setLocalValue(selectedValue.value);\n  }\n  watch(() => selectedValue == null ? void 0 : selectedValue.value, (newVal) => {\n    setHeaderValue(newVal);\n  });\n  function getDefaultLocalValue() {\n    return (selectedValue == null ? void 0 : selectedValue.value) || computedDefaultValue.value || getNow();\n  }\n  function resetHeaderValue(emitChange = true) {\n    const defaultLocalValue = getDefaultLocalValue();\n    if (emitChange) {\n      setHeaderValue(defaultLocalValue);\n    } else {\n      setLocalValue(defaultLocalValue);\n    }\n  }\n  const showSingleBtn = computed(() => span.value !== superSpan.value);\n  const headerOperations = computed(() => ({\n    onSuperPrev: () => {\n      setHeaderValue(methods.subtract(headerValue.value, superSpan.value, \"M\"));\n    },\n    onPrev: showSingleBtn.value ? () => {\n      setHeaderValue(methods.subtract(headerValue.value, span.value, \"M\"));\n    } : void 0,\n    onNext: showSingleBtn.value ? () => {\n      setHeaderValue(methods.add(headerValue.value, span.value, \"M\"));\n    } : void 0,\n    onSuperNext: () => {\n      setHeaderValue(methods.add(headerValue.value, superSpan.value, \"M\"));\n    }\n  }));\n  return {\n    headerValue,\n    setHeaderValue,\n    headerOperations,\n    resetHeaderValue,\n    getDefaultLocalValue\n  };\n}\nexport { useHeaderValue as default };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}