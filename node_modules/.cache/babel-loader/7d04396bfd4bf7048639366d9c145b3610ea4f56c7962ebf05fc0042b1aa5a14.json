{"ast":null,"code":"import _toConsumableArray from \"/root/FrontPlatform/vue-front/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport { ref, provide, onMounted, onUnmounted, computed, inject } from \"vue\";\nimport { isUndefined } from \"../../_utils/is.js\";\nimport { DataCollectorInjectionKey } from \"../context.js\";\nfunction getKeys(data, condition) {\n  var keys = [];\n  var loop = function loop(list) {\n    list.forEach(function (item) {\n      if (condition(item)) {\n        keys.push(item.key);\n      }\n      if (item.children) {\n        loop(item.children);\n      }\n    });\n  };\n  loop(data);\n  return keys;\n}\nfunction useMenuDataCollectorContext() {\n  var isRoot = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n  var menuContext = isRoot ? void 0 : inject(DataCollectorInjectionKey);\n  return menuContext;\n}\nfunction useMenuDataCollector(props) {\n  var key = props.key,\n    type = props.type;\n  var data = ref([]);\n  var menuContext = useMenuDataCollectorContext(type === \"menu\");\n  var provideContext = {\n    collectSubMenu: function collectSubMenu(key2, children) {\n      var isReport = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var item = {\n        key: key2,\n        children: children\n      };\n      if (isReport) {\n        var oldOne = data.value.find(function (i) {\n          return i.key === key2;\n        });\n        if (oldOne) {\n          oldOne.children = children;\n        } else {\n          data.value.push(item);\n        }\n      } else {\n        data.value = [].concat(_toConsumableArray(data.value), [item]);\n      }\n      if (isReport) {\n        if (type === \"popupMenu\") {\n          menuContext == null ? void 0 : menuContext.reportMenuData(data.value);\n        } else if (type === \"subMenu\" && !isUndefined(key2)) {\n          menuContext == null ? void 0 : menuContext.collectSubMenu(key2, data.value, true);\n        }\n      }\n    },\n    removeSubMenu: function removeSubMenu(key2) {\n      data.value = data.value.filter(function (item) {\n        return item.key !== key2;\n      });\n    },\n    collectMenuItem: function collectMenuItem(key2) {\n      data.value.push({\n        key: key2\n      });\n    },\n    removeMenuItem: function removeMenuItem(key2) {\n      data.value = data.value.filter(function (item) {\n        return item.key !== key2;\n      });\n    },\n    reportMenuData: function reportMenuData(reportData) {\n      data.value = reportData;\n      if (type === \"subMenu\" && !isUndefined(key)) {\n        menuContext == null ? void 0 : menuContext.collectSubMenu(key, data.value, true);\n      }\n    }\n  };\n  provide(DataCollectorInjectionKey, provideContext);\n  if (type === \"subMenu\" && !isUndefined(key)) {\n    onMounted(function () {\n      menuContext == null ? void 0 : menuContext.collectSubMenu(key, data.value);\n    });\n    onUnmounted(function () {\n      menuContext == null ? void 0 : menuContext.removeSubMenu(key);\n    });\n  } else if (type === \"popupMenu\") {\n    onMounted(function () {\n      menuContext == null ? void 0 : menuContext.reportMenuData(data.value);\n    });\n  }\n  return {\n    menuData: data,\n    subMenuKeys: computed(function () {\n      return getKeys(data.value, function (item) {\n        return !!item.children;\n      });\n    }),\n    menuItemKeys: computed(function () {\n      return getKeys(data.value, function (item) {\n        return !item.children;\n      });\n    })\n  };\n}\nexport { useMenuDataCollector as default, useMenuDataCollectorContext };","map":{"version":3,"names":["ref","provide","onMounted","onUnmounted","computed","inject","isUndefined","DataCollectorInjectionKey","getKeys","data","condition","keys","loop","list","forEach","item","push","key","children","useMenuDataCollectorContext","isRoot","arguments","length","undefined","menuContext","useMenuDataCollector","props","type","provideContext","collectSubMenu","key2","isReport","oldOne","value","find","i","concat","_toConsumableArray","reportMenuData","removeSubMenu","filter","collectMenuItem","removeMenuItem","reportData","menuData","subMenuKeys","menuItemKeys","default"],"sources":["/root/FrontPlatform/vue-front/node_modules/@arco-design/web-vue/es/menu/hooks/use-menu-data-collector.js"],"sourcesContent":["import { ref, provide, onMounted, onUnmounted, computed, inject } from \"vue\";\nimport { isUndefined } from \"../../_utils/is.js\";\nimport { DataCollectorInjectionKey } from \"../context.js\";\nfunction getKeys(data, condition) {\n  const keys = [];\n  const loop = (list) => {\n    list.forEach((item) => {\n      if (condition(item)) {\n        keys.push(item.key);\n      }\n      if (item.children) {\n        loop(item.children);\n      }\n    });\n  };\n  loop(data);\n  return keys;\n}\nfunction useMenuDataCollectorContext(isRoot = false) {\n  const menuContext = isRoot ? void 0 : inject(DataCollectorInjectionKey);\n  return menuContext;\n}\nfunction useMenuDataCollector(props) {\n  const { key, type } = props;\n  const data = ref([]);\n  const menuContext = useMenuDataCollectorContext(type === \"menu\");\n  const provideContext = {\n    collectSubMenu(key2, children, isReport = false) {\n      const item = {\n        key: key2,\n        children\n      };\n      if (isReport) {\n        const oldOne = data.value.find((i) => i.key === key2);\n        if (oldOne) {\n          oldOne.children = children;\n        } else {\n          data.value.push(item);\n        }\n      } else {\n        data.value = [...data.value, item];\n      }\n      if (isReport) {\n        if (type === \"popupMenu\") {\n          menuContext == null ? void 0 : menuContext.reportMenuData(data.value);\n        } else if (type === \"subMenu\" && !isUndefined(key2)) {\n          menuContext == null ? void 0 : menuContext.collectSubMenu(key2, data.value, true);\n        }\n      }\n    },\n    removeSubMenu(key2) {\n      data.value = data.value.filter((item) => item.key !== key2);\n    },\n    collectMenuItem(key2) {\n      data.value.push({ key: key2 });\n    },\n    removeMenuItem(key2) {\n      data.value = data.value.filter((item) => item.key !== key2);\n    },\n    reportMenuData(reportData) {\n      data.value = reportData;\n      if (type === \"subMenu\" && !isUndefined(key)) {\n        menuContext == null ? void 0 : menuContext.collectSubMenu(key, data.value, true);\n      }\n    }\n  };\n  provide(DataCollectorInjectionKey, provideContext);\n  if (type === \"subMenu\" && !isUndefined(key)) {\n    onMounted(() => {\n      menuContext == null ? void 0 : menuContext.collectSubMenu(key, data.value);\n    });\n    onUnmounted(() => {\n      menuContext == null ? void 0 : menuContext.removeSubMenu(key);\n    });\n  } else if (type === \"popupMenu\") {\n    onMounted(() => {\n      menuContext == null ? void 0 : menuContext.reportMenuData(data.value);\n    });\n  }\n  return {\n    menuData: data,\n    subMenuKeys: computed(() => getKeys(data.value, (item) => !!item.children)),\n    menuItemKeys: computed(() => getKeys(data.value, (item) => !item.children))\n  };\n}\nexport { useMenuDataCollector as default, useMenuDataCollectorContext };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}