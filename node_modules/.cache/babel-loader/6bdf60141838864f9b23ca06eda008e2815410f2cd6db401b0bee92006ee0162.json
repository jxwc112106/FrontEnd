{"ast":null,"code":"import _createClass from \"/root/FrontPlatform/vue-front/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _classCallCheck from \"/root/FrontPlatform/vue-front/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.set.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport { ref, watch, onMounted, onBeforeUnmount, readonly } from \"vue\";\nvar POPUP_BASE_Z_INDEX = 1e3;\nvar MESSAGE_BASE_Z_INDEX = 5e3;\nvar Z_INDEX_STEP = 1;\nvar PopupManager = /*#__PURE__*/_createClass(function PopupManager() {\n  var _this = this;\n  _classCallCheck(this, PopupManager);\n  this.popupStack = {\n    popup: new Set(),\n    dialog: new Set(),\n    message: new Set()\n  };\n  this.getNextZIndex = function (type) {\n    var current = type === \"message\" ? Array.from(_this.popupStack.message).pop() || MESSAGE_BASE_Z_INDEX : Array.from(_this.popupStack.popup).pop() || POPUP_BASE_Z_INDEX;\n    return current + Z_INDEX_STEP;\n  };\n  this.add = function (type) {\n    var zIndex = _this.getNextZIndex(type);\n    _this.popupStack[type].add(zIndex);\n    if (type === \"dialog\") {\n      _this.popupStack.popup.add(zIndex);\n    }\n    return zIndex;\n  };\n  this[\"delete\"] = function (zIndex, type) {\n    _this.popupStack[type][\"delete\"](zIndex);\n    if (type === \"dialog\") {\n      _this.popupStack.popup[\"delete\"](zIndex);\n    }\n  };\n  this.isLastDialog = function (zIndex) {\n    if (_this.popupStack.dialog.size > 1) {\n      return zIndex === Array.from(_this.popupStack.dialog).pop();\n    }\n    return true;\n  };\n});\nvar popupManager = new PopupManager();\nfunction usePopupManager(type) {\n  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n    visible = _ref.visible,\n    runOnMounted = _ref.runOnMounted;\n  var zIndex = ref(0);\n  var open = function open() {\n    zIndex.value = popupManager.add(type);\n  };\n  var close = function close() {\n    popupManager[\"delete\"](zIndex.value, type);\n  };\n  var isLastDialog = function isLastDialog() {\n    if (type === \"dialog\") {\n      return popupManager.isLastDialog(zIndex.value);\n    }\n    return false;\n  };\n  watch(function () {\n    return visible == null ? void 0 : visible.value;\n  }, function (visible2) {\n    if (visible2) {\n      open();\n    } else {\n      close();\n    }\n  }, {\n    immediate: true\n  });\n  if (runOnMounted) {\n    onMounted(function () {\n      open();\n    });\n    onBeforeUnmount(function () {\n      close();\n    });\n  }\n  return {\n    zIndex: readonly(zIndex),\n    open: open,\n    close: close,\n    isLastDialog: isLastDialog\n  };\n}\nexport { usePopupManager as default };","map":{"version":3,"names":["ref","watch","onMounted","onBeforeUnmount","readonly","POPUP_BASE_Z_INDEX","MESSAGE_BASE_Z_INDEX","Z_INDEX_STEP","PopupManager","_createClass","_this","_classCallCheck","popupStack","popup","Set","dialog","message","getNextZIndex","type","current","Array","from","pop","add","zIndex","isLastDialog","size","popupManager","usePopupManager","_ref","arguments","length","undefined","visible","runOnMounted","open","value","close","visible2","immediate","default"],"sources":["/root/FrontPlatform/vue-front/node_modules/@arco-design/web-vue/es/_hooks/use-popup-manager.js"],"sourcesContent":["import { ref, watch, onMounted, onBeforeUnmount, readonly } from \"vue\";\nconst POPUP_BASE_Z_INDEX = 1e3;\nconst MESSAGE_BASE_Z_INDEX = 5e3;\nconst Z_INDEX_STEP = 1;\nclass PopupManager {\n  constructor() {\n    this.popupStack = {\n      popup: new Set(),\n      dialog: new Set(),\n      message: new Set()\n    };\n    this.getNextZIndex = (type) => {\n      const current = type === \"message\" ? Array.from(this.popupStack.message).pop() || MESSAGE_BASE_Z_INDEX : Array.from(this.popupStack.popup).pop() || POPUP_BASE_Z_INDEX;\n      return current + Z_INDEX_STEP;\n    };\n    this.add = (type) => {\n      const zIndex = this.getNextZIndex(type);\n      this.popupStack[type].add(zIndex);\n      if (type === \"dialog\") {\n        this.popupStack.popup.add(zIndex);\n      }\n      return zIndex;\n    };\n    this.delete = (zIndex, type) => {\n      this.popupStack[type].delete(zIndex);\n      if (type === \"dialog\") {\n        this.popupStack.popup.delete(zIndex);\n      }\n    };\n    this.isLastDialog = (zIndex) => {\n      if (this.popupStack.dialog.size > 1) {\n        return zIndex === Array.from(this.popupStack.dialog).pop();\n      }\n      return true;\n    };\n  }\n}\nconst popupManager = new PopupManager();\nfunction usePopupManager(type, {\n  visible,\n  runOnMounted\n} = {}) {\n  const zIndex = ref(0);\n  const open = () => {\n    zIndex.value = popupManager.add(type);\n  };\n  const close = () => {\n    popupManager.delete(zIndex.value, type);\n  };\n  const isLastDialog = () => {\n    if (type === \"dialog\") {\n      return popupManager.isLastDialog(zIndex.value);\n    }\n    return false;\n  };\n  watch(() => visible == null ? void 0 : visible.value, (visible2) => {\n    if (visible2) {\n      open();\n    } else {\n      close();\n    }\n  }, {\n    immediate: true\n  });\n  if (runOnMounted) {\n    onMounted(() => {\n      open();\n    });\n    onBeforeUnmount(() => {\n      close();\n    });\n  }\n  return {\n    zIndex: readonly(zIndex),\n    open,\n    close,\n    isLastDialog\n  };\n}\nexport { usePopupManager as default };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}